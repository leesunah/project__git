Проект: Обучение с учителем: качество модели

Интернет-магазин «В один клик» продаёт разные товары: для детей, для дома, мелкую бытовую технику, косметику и даже продукты. Отчёт магазина за прошлый период показал, что активность покупателей начала снижаться. Привлекать новых клиентов уже не так эффективно: о магазине и так знает большая часть целевой аудитории.
Необходимо разработать решение, которое позволит персонализировать предложения постоянным клиентам, чтобы увеличить их покупательскую активность.
Предоставлены данные в табличной форме.
	•	market_file.csv - содержит данные о поведении покупателя на сайте, о коммуникациях с покупателем и его продуктовом поведении.
	?	id — номер покупателя в корпоративной базе данных.
	?	Покупательская активность — рассчитанный класс покупательской активности (целевой признак): «снизилась» или «прежний уровень».
	?	Тип сервиса — уровень сервиса, например «премиум» и «стандарт».
	?	Разрешить сообщать — информация о том, можно ли присылать покупателю дополнительные предложения о товаре. Согласие на это даёт покупатель.
	?	Маркет_актив_6_мес — среднемесячное значение маркетинговых коммуникаций компании, которое приходилось на покупателя за последние 6 месяцев. Это значение показывает, какое число рассылок, звонков, показов рекламы и прочего приходилось на клиента.
	?	Маркет_актив_тек_мес — количество маркетинговых коммуникаций в текущем месяце.
	?	Длительность — значение, которое показывает, сколько дней прошло с момента регистрации покупателя на сайте.
	?	Акционные_покупки — среднемесячная доля покупок по акции от общего числа покупок за последние 6 месяцев.
	?	Популярная_категория — самая популярная категория товаров у покупателя за последние 6 месяцев.
	?	Средний_просмотр_категорий_за_визит — показывает, сколько в среднем категорий покупатель просмотрел за визит в течение последнего месяца. Неоплаченные_продукты_штук_квартал — общее число неоплаченных товаров в корзине за последние 3 месяца.
	?	Ошибка_сервиса — число сбоев, которые коснулись покупателя во время посещения сайта.
	?	Страниц_за_визит — среднее количество страниц, которые просмотрел покупатель за один визит на сайт за последние 3 месяца.
	•	market_money.csv - с данными о выручке, которую получает магазин с покупателя, то есть сколько покупатель всего потратил за период взаимодействия с сайтом.
	?	id — номер покупателя в корпоративной базе данных.
	?	Период — название периода, во время которого зафиксирована выручка. Например, 'текущий_месяц' или 'предыдущий_месяц'.
	?	Выручка — сумма выручки за период.
	•	market_time.csv - с данными о времени (в минутах), которое покупатель провёл на сайте в течение периода.
	?	id — номер покупателя в корпоративной базе данных.
	?	Период — название периода, во время которого зафиксировано общее время.
	?	минут — значение времени, проведённого на сайте, в минутах.
	•	money.csv - с данными о среднемесячной прибыли покупателя за последние 3 месяца: какую прибыль получает магазин от продаж каждому покупателю.
	?	id — номер покупателя в корпоративной базе данных.
	?	Прибыль — значение прибыли.
Разобъем задачу на два этапа:
	1	Разработаем модель, которая предскажет вероятность снижения покупательской активности.
	2	Выделим сегмент покупателей, проанализируем его и предложим, как увеличить его покупательскую активность, используя данные моделирования, данные о прибыли покупателей и исходные данные (если понадобятся). Возможные сегменты:
	•	Группа клиентов с максимальной долей покупок по акции и высокой вероятностью снижения покупательской активности.
	•	Группа клиентов, которые покупают только технику, то есть товары с длинным жизненным циклом.
	•	Группа клиентов, которые покупают товары из категории «Товары для себя» (новая категория, которую можно выделить на основе текущих) или «Товары для детей».
	•	Группа клиентов с высокой вероятностью снижения покупательской активности и наиболее высокой прибыльностью.


В ходе исследования выполнены следующие этапы:

Предобработка данных
1. Произведено изменение названий столбцов:
* перевод в строчный формат
* замена пробелов на подчеркивание
2. В market_file
* в колонке тип_сервиса данные стандартт заменены на стандарт
3. В market_money
* в колонке периодданные препредыдущий_месяц заменены на предыдущий_месяц
4. В market_time
* в колонке период данные предыдцщий_месяц заменены на предыдущий_месяц

Анализ данных и подготовка
* Проведен исследовательский анализ данных.
* Проведена подготовка и объединение таблиц.
* Для поиска лучшей модели был проведен корреляционный анализ данных для исключения мультиколлинеарности.
* Подготовлены пайплайны для отбора лучшей модели в ручном и автоматическом режиме.

Лучшая модель
Наилучшей моделью была определена LogisticRegression(C=1, penalty='l1', random_state=42, solver='liblinear'). Метрика roc_auc для тестовой выборки показала результат 0.917.

Важные и малозначимые признаки
Наиболее значимые признаки, на которые следует обратить внимание для увеличения покупательской активности (по убыванию значимости):
* акционные_покупки
* средний_просмотр_категорий_за_визит
* страниц_за_визит
* минут_предыдущий_месяц
* минут_текущий_месяц
* маркет_актив_6_мес
Наименее важные признаки:
* разрешить_сообщать
* ошибка_сервиса
* длительность
* тип_сервиса
* маркет_актив_тек_мес
Cильнее всего влияют на целевую переменную количественные признаки, описывающие взаимодействие пользователя с сайтом (время на сайте, количество просматриваемых категорий и страниц), а так же число рассылок, звонков, показов рекламы за 6 месяцев. Уменьшение значений этих показателей повышают вероятность снижения покупательской активности клиента.
Признаки, описывающие финансовое и продуктовое поведение клиента (категории товаров) слабо влияют на прогнозирование снижения покупателской активности. Можно сказать только то, что увеличение популярности категории мелкая_бытовая_техника_и_электроника склоняет модель к негативному прогнозу (0).

Сегменты покупателей и рекомендации

Сегмент покупателей с большой долей акционных товаров
В этом сегменте наблюдается снижение покупательской активности. В выбранном сегменте акционные_покупки более более 0.6 покупатели меньше времени проводят на сайте, имеют больше неоплаченных товаров в корзине, меньше смотрят категорий и страниц, а так же на них приходится меньшее количество маркетинговых коммуникаций.
* Стоит увеличить маркетинговые коммуникации компании, предлагать им акционные товары и проводить рекламные кампании.

Сегмент покупателей с популярной категорией "Товары для детей"
В этом сегменте также наблюдается значительное снижение покупательской активности. Данный сегмент в основном покупают по акции, просматривают мало страниц и проводят меньше времени на сайте, чем покупатели, у которых активность осталась на прежнем уровне. Но данный сегмент покупателей проявляет высокий интерес к просмотру разных категорий товаров.
* Стоит увеличить ассортимент акционных товаров или систему рекомендаций товаров для увеличения количества просмотров страниц.

